{"version":3,"sources":["src/server/bridges/CloudWorkspaceBridge.ts"],"names":[],"mappings":";;;AAAA,6CAA0C;AAC1C,2EAAwE;AACxE,kEAA+D;AAC/D,2EAAwE;AAGxE,MAAsB,oBAAqB,SAAQ,uBAAU;IAClD,mBAAmB,CAAC,KAAa,EAAE,KAAa;QACnD,IAAI,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,EAAE;YACrC,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;SAC/C;IACL,CAAC;IAIO,uBAAuB,CAAC,KAAa;QACzC,IAAI,2CAAoB,CAAC,aAAa,CAAC,KAAK,EAAE,+BAAc,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,EAAE;YACpF,OAAO,IAAI,CAAC;SACf;QAED,2CAAoB,CAAC,gBAAgB,CACjC,IAAI,6CAAqB,CAAC;YACtB,KAAK;YACL,kBAAkB,EAAE,CAAC,+BAAc,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;SAChE,CAAC,CACL,CAAC;QAEF,OAAO,KAAK,CAAC;IACjB,CAAC;CACJ;AAvBD,oDAuBC","file":"CloudWorkspaceBridge.js","sourcesContent":["import { BaseBridge } from './BaseBridge';\nimport { AppPermissionManager } from '../managers/AppPermissionManager';\nimport { AppPermissions } from '../permissions/AppPermissions';\nimport { PermissionDeniedError } from '../errors/PermissionDeniedError';\nimport type { IWorkspaceToken } from '../../definition/cloud/IWorkspaceToken';\n\nexport abstract class CloudWorkspaceBridge extends BaseBridge {\n    public doGetWorkspaceToken(scope: string, appId: string): Promise<IWorkspaceToken> {\n        if (this.hasCloudTokenPermission(appId)) {\n            return this.getWorkspaceToken(scope, appId);\n        }\n    }\n\n    protected abstract getWorkspaceToken(scope: string, appId: string): Promise<IWorkspaceToken>;\n\n    private hasCloudTokenPermission(appId: string): boolean {\n        if (AppPermissionManager.hasPermission(appId, AppPermissions.cloud['workspace-token'])) {\n            return true;\n        }\n\n        AppPermissionManager.notifyAboutError(\n            new PermissionDeniedError({\n                appId,\n                missingPermissions: [AppPermissions.cloud['workspace-token']],\n            }),\n        );\n\n        return false;\n    }\n}\n"]}